<html lang="pl">
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>Kurs Javascript - adowanie grafiki</title>
</head>
	
t>
	<style>
		div#loading {width:600px; height:10px; background:#666666; overflow:hidden; margin:10px; border:1px solid #4C4C4C; padding:1px}
		div#pasekPostepu {width:0%; height:98%; background:#CF0000; overflow:hidden}
	</style>
<body>

<div class="top_bar" id="top_bar">
	<div><span><a href="../" class="back">Strona pocztkowa</a></span></div>
</div>

<div class="page_content">
	<h1 class="page_title">Preloading</h1>
	<p>
	Przykad pokazuje adowanie grafiki do cache przegldarki. adowanie takie odbywa si tylko 1 raz. Drugi raz skrypt od razu zaaduje grafik. Aby powtrnie zaadowa trzeba albo oczyci cache przegldarki, albo do kadej nazwy obrazka doda jaki randomowy query string np. <strong>?=Math.random()*99999</strong>. Jednak nam przecie nie o to chodzi :)
	</p>

	<input type="button" value="Zacznij adowanie grafiki" id="start_load" />

	<script>
//tablica z nazwami obrazkw do zaadowania
var nazwyObrazkow = [
    'obrazek1.gif',
    'obrazek2.gif',
  //  'obrazek3.gif',
  //  'obrazek4.gif',
  //  'obrazek5.gif',
  //  'obrazek6.gif'
];
var ile_zaladowano = 0; //ile obiektw Images ju zaadowano do pamici
var szerokosc_przeskoku = (100/nazwyObrazkow.length); //szeroko oznaczajca % paska po zaadowaniu 1 obrazka
var obr = []; //tablica bdzie zawieraa obiekty Image
var div = null; //zmienna pod ktr utworzymy dynamicznie div zawierajcego div-pasek postpu
var pasek = null; //zmienna pod ktr utworzymy dynamicznie div-pasek postpu
var strona = 'index.php'; //strona na ktr przeniesie po zakoczonym adowaniu
 
 
//funkcja rozpoczynajca adowanie obrazkw
function start_Loading() {
    div = document.createElement('div');
    div.id = 'loading';             //dziki temu skorzystamy ze zdefiniowanych styli
    pasek = document.createElement('div');
    pasek.id = 'pasekPostepu';
    div.appendChild(pasek);         //wstawiamy div-pasek postpu do diva
    document.getElementsByTagName('body')[0].appendChild(div);      //wstawiamy div na kocu body
 
    for(var x=0; x<nazwyObrazkow.length; x++) {      //ptla po nazwach obrazkw...
        obr[x] = new Image();
        obr[x].onload = ustawPasek;         //dla kadego obiektu ustawiamy zdarznie onload
        obr[x].src = nazwyObrazkow[x];          
    }
}
 
 
//funkcja odpalana dla kadego obiektu Image, ktre wczeniej stworzylimy. Sprawdza ile obiektw zostao zaoadowanych i ustawia odpowiedni szeroko paska
function ustawPasek() {
    ile_zaladowano++;
    pasek.style.width = ile_zaladowano * szerokosc_przeskoku + "%"; //zmianiamy szeroko paska (podan w %)
     
    if (ile_zaladowano >= nazwyObrazkow.length) {
        setTimeout("location.href='"+strona+"'", 2000) //po zaadowaniu wszystkich grafik czekamy 2s i przenosimy na stron
    }
}
 
document.getElementById('start_load').onclick = start_Loading;
</script>
</div>
</body>
</html>